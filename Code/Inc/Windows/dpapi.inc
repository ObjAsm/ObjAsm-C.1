;Include file created by h2incX, Version B.01.01, 10/09/2018 22:03
;(C) 2018-today by Biterider, 2005-2009 by Japheth
;Source file: '\ObjAsm\Projects\h2IncX\header\dpapi.h', last modified: 19/04/2018 10:43
;Creation parameters: 

ifndef __DPAPI_H__
  __DPAPI_H__ equ <>
  if (_MSC_VER gt 1020)
  endif
  if (NTDDI_VERSION ge NTDDI_WIN8)
    if  not Defined(DPAPI_IMP)
      DPAPI_IMP equ <>
    endif
  else
    if  not Defined(_CRYPT32_)
      DPAPI_IMP equ <DECLSPEC_IMPORT>
    else
      DPAPI_IMP equ <>
    endif
  endif
  ifdef __cplusplus
    ;[...]
  endif
  if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_APP or WINAPI_PARTITION_SYSTEM)
    ifndef CRYPTO_BLOBS_DEFINED
      CRYPTO_BLOBS_DEFINED equ <>
      CRYPT_INTEGER_BLOB struct
        cbData DWORD ?
        pbData POINTER ?
      CRYPT_INTEGER_BLOB ends

      _CRYPTOAPI_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_INTEGER_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_UINT_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_UINT_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_OBJID_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_OBJID_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CERT_NAME_BLOB typedef CRYPT_INTEGER_BLOB
      PCERT_NAME_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CERT_RDN_VALUE_BLOB typedef CRYPT_INTEGER_BLOB
      PCERT_RDN_VALUE_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CERT_BLOB typedef CRYPT_INTEGER_BLOB
      PCERT_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRL_BLOB typedef CRYPT_INTEGER_BLOB
      PCRL_BLOB typedef ptr CRYPT_INTEGER_BLOB
      DATA_BLOB typedef CRYPT_INTEGER_BLOB
      PDATA_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_DATA_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_DATA_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_HASH_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_HASH_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_DIGEST_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_DIGEST_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_DER_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_DER_BLOB typedef ptr CRYPT_INTEGER_BLOB
      CRYPT_ATTR_BLOB typedef CRYPT_INTEGER_BLOB
      PCRYPT_ATTR_BLOB typedef ptr CRYPT_INTEGER_BLOB
      
    endif
    szFORCE_KEY_PROTECTION equ <"ForceKeyProtection">
    dwFORCE_KEY_PROTECTION_DISABLED equ 0h
    dwFORCE_KEY_PROTECTION_USER_SELECT equ 1h
    dwFORCE_KEY_PROTECTION_HIGH equ 2h
    CRYPTPROTECT_PROMPTSTRUCT struct
      cbSize DWORD ?
      dwPromptFlags DWORD ?
      hwndApp HWND ?
      szPrompt LPCWSTR ?
    CRYPTPROTECT_PROMPTSTRUCT ends

    _CRYPTPROTECT_PROMPTSTRUCT typedef CRYPTPROTECT_PROMPTSTRUCT
    PCRYPTPROTECT_PROMPTSTRUCT typedef ptr CRYPTPROTECT_PROMPTSTRUCT
    
    CRYPTPROTECT_DEFAULT_PROVIDER equ { 0df9d8cd0h, 1501h, 11d1h, { 8ch, 7ah, 00h, 0c0h, 4fh, 0c2h, 97h, 0ebh } }
    CRYPTPROTECT_PROMPT_ON_UNPROTECT equ 1h
    CRYPTPROTECT_PROMPT_ON_PROTECT equ 2h
    CRYPTPROTECT_PROMPT_RESERVED equ 04h
    CRYPTPROTECT_PROMPT_STRONG equ 08h
    CRYPTPROTECT_PROMPT_REQUIRE_STRONG equ 10h
    CRYPTPROTECT_UI_FORBIDDEN equ 1h
    CRYPTPROTECT_LOCAL_MACHINE equ 4h
    CRYPTPROTECT_CRED_SYNC equ 8h
    CRYPTPROTECT_AUDIT equ 10h
    CRYPTPROTECT_NO_RECOVERY equ 20h
    CRYPTPROTECT_VERIFY_PROTECTION equ 40h
    CRYPTPROTECT_CRED_REGENERATE equ 80h
    CRYPTPROTECT_FIRST_RESERVED_FLAGVAL equ 0FFFFFFFh
    CRYPTPROTECT_LAST_RESERVED_FLAGVAL equ 0FFFFFFFFh
    @DefProto DllImport, CryptProtectData, WIN_STD_CALL_CONV,, <:ptr DATA_BLOB, :LPCWSTR, :ptr DATA_BLOB, :PVOID, :ptr CRYPTPROTECT_PROMPTSTRUCT, :DWORD, :ptr DATA_BLOB>, 28
    @DefProto DllImport, CryptUnprotectData, WIN_STD_CALL_CONV,, <:ptr DATA_BLOB, :ptr LPWSTR, :ptr DATA_BLOB, :PVOID, :ptr CRYPTPROTECT_PROMPTSTRUCT, :DWORD, :ptr DATA_BLOB>, 28
  endif
  if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)
    if (NTDDI_VERSION ge NTDDI_WIN8)
      CryptProtectDataNoUI proto WIN_STD_CALL_CONV :ptr DATA_BLOB, :LPCWSTR, :ptr DATA_BLOB, :PVOID, :ptr CRYPTPROTECT_PROMPTSTRUCT, :DWORD, :ptr BYTE, :DWORD, :ptr DATA_BLOB
      CryptUnprotectDataNoUI proto WIN_STD_CALL_CONV :ptr DATA_BLOB, :ptr LPWSTR, :ptr DATA_BLOB, :PVOID, :ptr CRYPTPROTECT_PROMPTSTRUCT, :DWORD, :ptr BYTE, :DWORD, :ptr DATA_BLOB
    endif
  endif
  if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP or WINAPI_PARTITION_SYSTEM)
    if (NTDDI_VERSION ge NTDDI_VISTA)
      @DefProto DllImport, CryptUpdateProtectedState, WIN_STD_CALL_CONV,, <:PSID, :LPCWSTR, :DWORD, :ptr DWORD, :ptr DWORD>, 20
    endif
  endif
  if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_APP or WINAPI_PARTITION_SYSTEM)
    CRYPTPROTECTMEMORY_BLOCK_SIZE equ 16
    CRYPTPROTECTMEMORY_SAME_PROCESS equ 00h
    CRYPTPROTECTMEMORY_CROSS_PROCESS equ 01h
    CRYPTPROTECTMEMORY_SAME_LOGON equ 02h
    @DefProto DllImport, CryptProtectMemory, WIN_STD_CALL_CONV,, <:LPVOID, :DWORD, :DWORD>, 12
    @DefProto DllImport, CryptUnprotectMemory, WIN_STD_CALL_CONV,, <:LPVOID, :DWORD, :DWORD>, 12
  endif
  ifdef __cplusplus
    ;[...]
  endif
endif

